<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Huwenbo Shi">
        <link rel="canonical" href="https://huwenboshi.github.io/x-ldsc/gcorsq/">
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Squared trans-ethnic genetic correlation - X-LDSC</title>
        <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../css/highlight.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
	
	<script src="../js/jquery-1.10.2.min.js"></script>
        <script src="../js/bootstrap-3.0.3.min.js"></script>
        <script src="../js/highlight.pack.js"></script>
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-XXXXXXXX-X', 'auto');
            ga('send', 'pageview');
        </script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="..">X-LDSC</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                    <li >
                        <a href="..">Home</a>
                    </li>
                    <li >
                        <a href="../input_format/">Input Format</a>
                    </li>
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Estimation <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../ldscore/">LD score</a>
</li>
                            
<li class="active">
    <a href="./">Squared trans-ethnic genetic correlation</a>
</li>
                        </ul>
                    </li>
                    <li >
                        <a href="../faq/">FAQ</a>
                    </li>
                </ul>

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                    <li >
                        <a rel="next" href="../ldscore/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../faq/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                    <li>
                        <a href="https://github.com/huwenboshi/x-ldsc">
                                <i class="fa fa-github"></i>GitHub
                        </a>
                    </li>
            </ul>
        </div>
    </div>
</div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#estimating-stratified-squared-trans-ethnic-genetic-correlation-and-its-enrichment">Estimating stratified squared trans-ethnic genetic correlation and its enrichment</a></li>
            <li><a href="#typical-command">Typical command</a></li>
            <li><a href="#output">Output</a></li>
            <li><a href="#continuous-valued-annotations">Continuous-valued annotations</a></li>
            <li><a href="#expected-92r2_gc92-and-92lambda2c92-from-continuous-valued-annotations">Expected \(r^2_g(C)\) and \(\lambda^2(C)\) from continuous-valued annotations</a></li>
            <li><a href="#interpreting-the-output">Interpreting the output</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="estimating-stratified-squared-trans-ethnic-genetic-correlation-and-its-enrichment">Estimating stratified squared trans-ethnic genetic correlation and its enrichment</h1>
<p>This page describes how to estimate stratified squared trans-ethnic genetic
correlation, \(r^2_{g}(C)\), and its enrichment, \(\lambda^2(C)\).</p>
<h3 id="typical-command">Typical command</h3>
<p>S-LDXR estimates \(r^2_{g}(C)\) and \(\lambda^2(C)\) with the
following command.</p>
<div class="codehilite"><pre><span></span>python &lt;software directory&gt;/s-ldxr.py \
    --gcor &lt;summary stats directory for EAS&gt;/EAS_sumstats.gz \
           &lt;summary stats directory for EUR&gt;/EUR_sumstats.gz \
    --ref-ld-chr &lt;baseline LD score directory&gt;/EAS_EUR_baseline_chr \
                 &lt;AVGLLD LD score directory&gt;/EAS_EUR_avglld_chr \
                 &lt;BSTAT LD score directory&gt;/EAS_EUR_bstat_chr \
                 &lt;ALLELEAGE LD score directory&gt;/EAS_EUR_alleleage_chr \
    --w-ld-chr &lt;regression weight directory&gt;/EAS_EUR_weight_chr \
    --frqfile &lt;EAS MAF directory&gt;/1000G.EAS. \
              &lt;EUR MAF directory&gt;/1000G.EUR. \
    --annot &lt;baseline annotation directory&gt;/baseline. \
            &lt;AVGLLD annotation directory&gt;/avglld. \
            &lt;BSTAT annotation directory&gt;/bstat. \
            &lt;ALLELEAGE annotation directory&gt;/alleleage. \
    --apply-shrinkage 0.5 \
    --save-pseudo-coef \
    --out TRAIT_EAS_EUR.txt
</pre></div>


<p>Here are the meanings of the flags:</p>
<ul>
<li>
<p><code>--gcor</code> specifies the summary stats files. This flag takes 2 arguments -
summary stats for population 1 and summary stats for population 2.</p>
</li>
<li>
<p><code>--ref-ld-chr</code> specifies prefix of the LD score files. This flag takes one
or more arguments â€“ one may put as many LD score files as one wishes.</p>
</li>
<li>
<p><code>--w-ld-chr</code> specifies prefix of the regression weights. These are
standardized LD scores calculated from regression SNPs.</p>
</li>
<li>
<p><code>--frqfile</code> specifies prefix of minor allele frequency files.</p>
</li>
<li>
<p><code>--annot</code> specifies prefix of the annotation files. This flags also takes
one or more arguments.</p>
</li>
</ul>
<div style="background-color:rgba(230, 230, 250, 1.0);">
<b>Note</b>: The order one specifies the annotation files must
be the same as the order one specifies the LD score files. The annotation
files must also be the same files that one uses to obtain the LD scores.
</div>

<ul>
<li>
<p><code>--apply-shrinkage</code> adjusts the level of shrinkage (the \(\alpha\) tuning
parameter in the paper). This should be a number between 0 and 1.</p>
</li>
<li>
<p><code>--save-pseudo-coef</code> If this flag is specified, jackknife pseudo values of
the coefficients will be saved. This flag is optional.</p>
</li>
<li>
<p><code>--out</code> specifies the output file name.</p>
</li>
</ul>
<h3 id="output">Output</h3>
<p>After executing the above command, 5 files will be generated.</p>
<ul>
<li>
<p><code>TRAIT_EAS_EUR.txt</code> output file containing the estimates.</p>
</li>
<li>
<p><code>TRAIT_EAS_EUR.txt.log</code> log file containing information for debugging.</p>
</li>
<li>
<p><code>TRAIT_EAS_EUR.txt.pseudo_tau1.gz</code> jackknife pseudo values for \(\tau_C\)
coefficients for population 1.</p>
</li>
<li>
<p><code>TRAIT_EAS_EUR.txt.pseudo_tau2.gz</code> jackknife pseudo values for \(\tau_C\)
coefficients for population 2.</p>
</li>
<li>
<p><code>TRAIT_EAS_EUR.txt.pseudo_theta.gz</code> jackknife pseudo values for
\(\theta_C\) genetic covariance coefficients.</p>
</li>
</ul>
<div style="background-color:rgba(230, 230, 250, 1.0);">
<b>Note</b>: The pseudo coefficients will only be saved if the
--save-pseudo-coef flag is specified.
</div>

<h3 id="continuous-valued-annotations">Continuous-valued annotations</h3>
<p>The following command estimates enrichment of stratified squared trans-ethnic
genetic correlation of quintiles of continuous-valued annotations.</p>
<div class="codehilite"><pre><span></span>python &lt;software directory&gt;/cont_annot_gcor.py \
    --coef TRAIT_EAS_EUR.txt \
    --frqfile &lt;EAS MAF directory&gt;/1000G.EAS. \
              &lt;EUR MAF directory&gt;/1000G.EUR. \
    --annot &lt;baseline annotation directory&gt;/baseline. \
            &lt;AVGLLD annotation directory&gt;/avglld. \
            &lt;BSTAT annotation directory&gt;/bstat. \
            &lt;ALLELEAGE annotation directory&gt;/alleleage. \
    --names AVGLLD BSTAT ALLELEAGE \
    --nbins 5 \
    --out TRAIT_EAS_EUR_contannot.txt
</pre></div>


<p>Here are the meanings of the flags.</p>
<ul>
<li>
<p><code>--coef</code> specifies the output from the previous step. The jackknife pseudo
coefficients will be loaded automatically.</p>
</li>
<li>
<p><code>--frqfile</code> specifies prefix of minor allele frequency files.</p>
</li>
<li>
<p><code>--annot</code> specifies prefix of the annotation files. This flags also takes
one or more arguments.</p>
</li>
</ul>
<div style="background-color:rgba(230, 230, 250, 1.0);">
<b>Note</b>: The order one specifies the annotation files must be the same as the
order of annotations in TRAIT_EAS_EUR.txt.
</div>

<ul>
<li>
<p><code>--names</code> specifies the names of the continuous annotations for which one
wishes to compute enrichment at quintiles.</p>
</li>
<li>
<p><code>--nbins</code> specifies the number of bins to bin the SNPs based on the values
of their continuous annotation. The default is 5 (i.e. quintiles).</p>
</li>
<li>
<p><code>--out</code> specifies the output file name.</p>
</li>
</ul>
<p>Additionally, users may use the <code>--apply-shrinkage</code> flag to adjust the level
of shrinkage.</p>
<p>After executing the above command, 2 files will be created.</p>
<ul>
<li>
<p><code>TRAIT_EAS_EUR_contannot.txt</code> contains the estimates.</p>
</li>
<li>
<p><code>TRAIT_EAS_EUR_contannot.txt.log</code> is the log file for debugging purpose.</p>
</li>
</ul>
<h3 id="expected-92r2_gc92-and-92lambda2c92-from-continuous-valued-annotations">Expected \(r^2_g(C)\) and \(\lambda^2(C)\) from continuous-valued annotations</h3>
<p>Estimating expected \(r^2_g(C)\) and \(\lambda^2(C)\) from
continuous-valued annotations requires two steps.</p>
<p>The first step gets the coefficients (\(\tau_{1C}\), \(\tau_{2C}\),
and \(\theta_{C}\)) of each continuous-valued annotations</p>
<div class="codehilite"><pre><span></span>python &lt;software directory&gt;/s-ldxr.py \
    --gcor &lt;summary stats directory for EAS&gt;/EAS_sumstats.gz \
           &lt;summary stats directory for EUR&gt;/EUR_sumstats.gz \
    --ref-ld-chr &lt;base LD score directory&gt;/EAS_EUR_allelic_chr \
                 &lt;AVGLLD LD score directory&gt;/EAS_EUR_allelic_chr \
                 &lt;BSTAT LD score directory&gt;/EAS_EUR_allelic_chr \
                 &lt;ALLELEAGE LD score directory&gt;/EAS_EUR_allelic_chr \
    --w-ld-chr &lt;regression weight directory&gt;/EAS_EUR_weight_chr \
    --frqfile &lt;EAS MAF directory&gt;/1000G.EAS. \
              &lt;EUR MAF directory&gt;/1000G.EUR. \
    --annot &lt;base annotation directory&gt;/base. \
            &lt;AVGLLD annotation directory&gt;/avglld. \
            &lt;BSTAT annotation directory&gt;/bstat. \
            &lt;ALLELEAGE annotation directory&gt;/alleleage. \
    --save-pseudo-coef \
    --out ./TRAIT_EAS_EUR_step1.txt
</pre></div>


<div style="background-color:rgba(230, 230, 250, 1.0);">
<b>Note</b>: It is important to always include the base (not
baseline) annotation.
</div>

<p>The output is the same as that of a typical command.</p>
<p>The second step uses the coefficients from the first step to obtain expected
\(r^2_g(C)\) and \(\lambda^2(C)\) from continuous-valued annotations.</p>
<div class="codehilite"><pre><span></span>python &lt;software directory&gt;/pred_binannot_from_contannot.py \
    --coef ./TRAIT_EAS_EUR_step1.txt \
    --frqfile &lt;EAS MAF directory&gt;/1000G.EAS. \
              &lt;EUR MAF directory&gt;/1000G.EUR. \
    --cont-annot &lt;base annotation directory&gt;/base. \
                 &lt;AVGLLD annotation directory&gt;/avglld. \
                 &lt;BSTAT annotation directory&gt;/bstat. \
                 &lt;ALLELEAGE annotation directory&gt;/alleleage. \
    --bin-annot &lt;base annotation directory&gt;/base. \
                &lt;binary annotation directory&gt;/annot_name. \
    --apply-shrinkage 0.5 \
    --out ./TRAIT_EAS_EUR_step2.txt
</pre></div>


<div style="background-color:rgba(230, 230, 250, 1.0);">
<b>Note</b>: It is important to always include the base (not
baseline) annotation.
</div>

<p>The output is the same as that of the command for continuous-valued
annotations.</p>
<h3 id="interpreting-the-output">Interpreting the output</h3>
<p>The output files of S-LDXR contain the following columns.</p>
<ol>
<li>
<p><code>ANNOT</code> name of the annotation</p>
</li>
<li>
<p><code>NSNP</code> number of SNPs for binary annotations (sum of annotation values for
continuous-valued annotations)</p>
</li>
<li>
<p><code>STD</code> standard deviation of the annotation across SNPs</p>
</li>
<li>
<p><code>TAU1</code> heritability coefficient of population 1</p>
</li>
<li>
<p><code>TAU1_SE</code> standard error heritability coefficient of population 1</p>
</li>
<li>
<p><code>TAU2</code> heritability coefficient of population 2</p>
</li>
<li>
<p><code>TAU2_SE</code> standard error heritability coefficient of population 2</p>
</li>
<li>
<p><code>THETA</code> trans-ethnic genetic covariance coefficient</p>
</li>
<li>
<p><code>THETA_SE</code> standard error of trans-ethnic genetic covariance coefficient</p>
</li>
<li>
<p><code>HSQ1</code> heritability in population 1</p>
</li>
<li>
<p><code>HSQ1_SE</code> standard error of heritability in population 1</p>
</li>
<li>
<p><code>HSQ2</code> heritability in population 2</p>
</li>
<li>
<p><code>HSQ2_SE</code> standard error of heritability in population 2</p>
</li>
<li>
<p><code>GCOV</code> trans-ethnic genetic covariance</p>
</li>
<li>
<p><code>GCOV_SE</code> standard error of trans-ethnic genetic covariance</p>
</li>
<li>
<p><code>GCORSQ</code> stratified squared trans-ethnic genetic correlation</p>
</li>
<li>
<p><code>GCORSQ_SE</code> standard error of stratified squared trans-ethnic genetic
correlation </p>
</li>
<li>
<p><code>HSQ1_ENRICHMENT</code> heritability enrichment in population 1</p>
</li>
<li>
<p><code>HSQ1_ENRICHMENT_SE</code> standard error of heritability enrichment in
population 1</p>
</li>
<li>
<p><code>HSQ2_ENRICHMENT</code> heritability enrichment in population 2</p>
</li>
<li>
<p><code>HSQ2_ENRICHMENT_SE</code> standard error of heritability enrichment in
population 2</p>
</li>
<li>
<p><code>GCOV_ENRICHMENT</code> genetic covariance enrichment</p>
</li>
<li>
<p><code>GCOV_ENRICHMENT_SE</code> standard error of genetic covariance enrichment</p>
</li>
<li>
<p><code>GCORSQ_ENRICHMENT</code> estimated enrichment of stratified squared trans-ethnic
genetic correlation enrichment</p>
</li>
<li>
<p><code>GCORSQ_ENRICHMENT_SE</code> standard error of estimated enrichment of stratified
squared trans-ethnic genetic correlation</p>
</li>
</ol></div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>Copyright &copy; 2019 - 2024 Huwenbo Shi</p>
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>var base_url = '..';</script>
        <script data-main="../mkdocs/js/search.js" src="../mkdocs/js/require.js"></script>
        <script src="../js/base.js"></script>
        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
        <script src="../assets/mathjaxhelper.js"></script><div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
